<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Gestione Slot</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="data:;base64,=">
</head>
<body>

  <!-- Menù -->
  <nav>
    <div class="dropdown">
      <button class="dropdown-button">Menù</button>
      <div class="dropdown-content">
        <a href="#" id="logoutMenuItem">Logout</a>
      </div>
    </div>
  </nav>

  <!-- Calendario -->
  <div class="calendar-container">
    <div class="calendar-nav">
      <button id="prevMonth">&lt;</button>
      <span id="monthYear"></span>
      <button id="nextMonth">&gt;</button>
    </div>
    <table class="calendar">
      <thead>
        <tr>
          <th>Lunedì</th>
          <th>Martedì</th>
          <th>Mercoledì</th>
          <th>Giovedì</th>
          <th>Venerdì</th>
          <th>Sabato</th>
          <th>Domenica</th>
        </tr>
      </thead>
      <tbody id="calendarBody"></tbody>
    </table>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Dropdown Menù
      const menuBtn     = document.querySelector('.dropdown-button');
      const menuContent = document.querySelector('.dropdown-content');
      menuBtn.addEventListener('click', e => {
        e.stopPropagation();
        menuContent.style.display =
          menuContent.style.display === 'block' ? 'none' : 'block';
      });
      document.addEventListener('click', e => {
        if (!menuBtn.contains(e.target)) menuContent.style.display = 'none';
      });

      // Logout
      document.getElementById('logoutMenuItem').addEventListener('click', e => {
        e.preventDefault();
        // TODO: logout su Firebase, poi location.href='index.html'
      });

      // Calendar logic (stesso di sopra)
      const monthYearEl = document.getElementById('monthYear');
      const bodyEl      = document.getElementById('calendarBody');
      let now = new Date(),
          currentYear  = now.getFullYear(),
          currentMonth = now.getMonth();

      const monthNames = ["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno",
                          "Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"];
      function renderCalendar(year, month) {
        monthYearEl.textContent = `${monthNames[month]} ${year}`;
        bodyEl.innerHTML = '';
        const firstDay = new Date(year, month, 1).getDay();
        const shift    = (firstDay + 6) % 7;
        const daysInMonth = new Date(year, month+1, 0).getDate();
        let day = 1;
        for (let w = 0; w < 6; w++) {
          const tr = document.createElement('tr');
          for (let d = 0; d < 7; d++) {
            const td = document.createElement('td');
            if ((w===0 && d<shift) || day>daysInMonth) {
            } else {
              const span = document.createElement('span');
              span.className = 'day-number';
              span.textContent = day;
              td.appendChild(span);
              if (d === 6) td.classList.add('holiday');
              day++;
            }
            tr.appendChild(td);
          }
          bodyEl.appendChild(tr);
          if (day > daysInMonth) break;
        }
      }

      document.getElementById('prevMonth').addEventListener('click', () => {
        currentMonth--;
        if (currentMonth < 0) { currentMonth = 11; currentYear--; }
        renderCalendar(currentYear, currentMonth);
      });
      document.getElementById('nextMonth').addEventListener('click', () => {
        currentMonth++;
        if (currentMonth > 11) { currentMonth = 0; currentYear++; }
        renderCalendar(currentYear, currentMonth);
      });

      renderCalendar(currentYear, currentMonth);
    });
  </script>

</body>
</html>
